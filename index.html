<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Camera Dashboard</title>
    <style>
        #motion-notification {
            animation: fadeInOut 3s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0%, 100% {
                opacity: 0;
            }
            10%, 90% {
                opacity: 1;
            }
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            background-color: #0a0a23;
            color: white;
        }
        .sidebar {
            width: 20%;
            background-color: #7b5ca5;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
        }
        .sidebar button {
            background-color: #4a3c8c;
            color: white;
            border: none;
            margin: 10px 0;
            padding: 15px;
            font-size: 16px;
            width: 90%;
            cursor: pointer;
            text-align: center;
            border-radius: 5px;
        }
        .sidebar button:hover {
            background-color: #5f4aa1;
        }
        .main-content {
            width: 80%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        #camera-feed {
            width: 80%;
            height: 400px;
            border: 5px solid #8a5fc7;
            background-color: white;
            box-shadow: 0 0 20px #8a5fc7, 0 0 40px #8a5fc7, 0 0 60px #8a5fc7;
            transition: box-shadow 0.3s ease-in-out;
        }
        #camera-feed:hover {
            box-shadow: 0 0 30px #8a5fc7, 0 0 60px #8a5fc7, 0 0 80px #8a5fc7;
        }
        select, input, button {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
        }
        .controls, .playback {
            margin-top: 20px;
            text-align: center;
        }
        .timeline {
            width: 80%;
            margin: 20px auto;
            height: 5px;
            background-color: #ccc;
            position: relative;
        }
        .timeline-progress {
            height: 100%;
            background-color: #4caf50;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>SECURITY CAMERA</h2>
        <button id="camera-mode">Camera Mode</button>
        <button id="live-feed-control">Live Feed Control</button>
        <button id="playback-mode">Playback Mode</button>
        <button id="exit">Exit</button>
    </div>

    <div class="main-content">
        <video id="camera-feed" autoplay></video>

        <!-- Camera Mode -->
        <div id="camera-mode-options" class="controls" style="display:none;">
            <h2>Camera Modes</h2>
            <select id="camera-mode-select">
                <option value="basic">Basic Surveillance Mode</option>
                <option value="ultra-safe">Ultra Safe Mode</option>
            </select>
            <button onclick="switchCameraMode()">Apply Mode</button>
        </div>

        <!-- Live Feed Control -->
        <div id="live-feed-options" class="controls" style="display:none;">
            <h2>Live Feed Control</h2>
            <select id="live-feed-select">
                <option value="zoom-in">Zoom In</option>
                <option value="zoom-out">Zoom Out</option>
                <option value="snapshot">Take Snapshot</option>
            </select>
            <button onclick="controlLiveFeed()">Execute</button>
        </div>

        <!-- Playback Mode -->
        <div id="playback-options" class="playback" style="display:none;">
            <h2>Playback Mode</h2>
            <label>Select Date & Time Range:</label>
            <input type="datetime-local" id="start-time">
            <input type="datetime-local" id="end-time">
            <button onclick="playback()">Search</button>

            <div class="timeline">
                <div class="timeline-progress" id="timeline-progress"></div>
            </div>
            <button onclick="exportClip()">Export Video Clip</button>
        </div>
    </div>

    <!-- <script>
        let zoomLevel = 1;
        let isUltraSafeMode = false;
        let mediaRecorder;
        let recordedChunks = [];

        const socket = new WebSocket('ws://localhost:8888');

        socket.onmessage = function (event) {
            if (event.data === 'motion_detected') {
                const notification = document.getElementById('notification');
                notification.style.display = 'block';
                console.log('Motion detected!');

                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
        };
        function displayNotification(message) {
            const notification = document.createElement("div");
            notification.id = "motion-notification";
            notification.innerText = message;
            notification.style.position = "absolute";
            notification.style.top = "10px";
            notification.style.left = "50%";
            notification.style.transform = "translateX(-50%)";
            notification.style.padding = "15px 30px";
            notification.style.backgroundColor = "#ff0000";
            notification.style.color = "white";
            notification.style.fontWeight = "bold";
            notification.style.zIndex = "1000";
            notification.style.borderRadius = "8px";
            notification.style.boxShadow = "0 0 15px rgba(255, 0, 0, 0.7)";
            document.body.appendChild(notification);
        
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // Switch Camera Mode logic
        function switchCameraMode() {
            const mode = document.getElementById("camera-mode-select").value;
            if (mode === "ultra-safe") {
                isUltraSafeMode = true;
                startScreenRecording();
                displayNotification("Ultra Safe Mode Activated");
            } else {
                isUltraSafeMode = false;
                stopScreenRecording();
                displayNotification("Switched to Basic Surveillance Mode");
            }
            console.log("Switched to", mode);
        }
        
        // Screen recording logic
        async function startScreenRecording() {
            try {
                const stream = await navigator.mediaDevices.getDisplayMedia({
                    video: true,
                    audio: false,
                });
        
                mediaRecorder = new MediaRecorder(stream);
                mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) {
                        recordedChunks.push(event.data);
                    }
                };
                mediaRecorder.start();
                console.log("Screen recording started.");
            } catch (error) {
                console.error("Error starting screen recording:", error);
            }
        }
        
        function stopScreenRecording() {
            if (mediaRecorder) {
                mediaRecorder.stop();
                console.log("Screen recording stopped.");
            }
        }
        
        // Playback functionality
        function playback() {
            const startTime = new Date(document.getElementById("start-time").value);
            const endTime = new Date(document.getElementById("end-time").value);
        
            if (recordedChunks.length === 0) {
                alert("No recorded footage available.");
                return;
            }
        
            const blob = new Blob(recordedChunks, { type: "video/webm" });
            const videoURL = URL.createObjectURL(blob);
            const videoPlayer = document.createElement("video");
            videoPlayer.src = videoURL;
            videoPlayer.controls = true;
            videoPlayer.style.width = "80%";
            videoPlayer.style.marginTop = "20px";
        
            const playbackContainer = document.getElementById("playback-options");
            playbackContainer.appendChild(videoPlayer);
        
            console.log(Searching playback from ${startTime} to ${endTime});
        }
        
        // Export video clip
        function exportClip() {
            if (recordedChunks.length === 0) {
                alert("No recorded footage available to export.");
                return;
            }
        
            const blob = new Blob(recordedChunks, { type: "video/webm" });
            const downloadLink = document.createElement("a");
            downloadLink.href = URL.createObjectURL(blob);
            downloadLink.download = security_footage_${Date.now()}.webm;
            downloadLink.click();
        
            console.log("Exporting video clip...");
        }
        function switchCameraMode() {
            const mode = document.getElementById("camera-mode-select").value;
            console.log("Switched to", mode);
        }

        function controlLiveFeed() {
            const action = document.getElementById("live-feed-select").value;
            if (action === "zoom-in") zoomIn();
            else if (action === "zoom-out") zoomOut();
            else if (action === "snapshot") takeSnapshot();
        }
        

        function playback() {
            const startTime = document.getElementById("start-time").value;
            const endTime = document.getElementById("end-time").value;
            console.log(Searching playback from ${startTime} to ${endTime});
        }

        function exportClip() {
            console.log("Exporting video clip...");
        }

        function zoomIn() {
            zoomLevel += 0.1;
            document.getElementById("camera-feed").style.transform = scale(${zoomLevel});
        }

        function zoomOut() {
            if (zoomLevel > 0.1) {
                zoomLevel -= 0.1;
                document.getElementById("camera-feed").style.transform = scale(${zoomLevel});
            }
        }

        function takeSnapshot() {
            const video = document.getElementById("camera-feed");
            const canvas = document.createElement("canvas");
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext("2d");
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            const dataURL = canvas.toDataURL("image/png");
            const link = document.createElement("a");
            link.href = dataURL;
            link.download = "snapshot.png";
            link.click();
        }

        document.getElementById("camera-mode").addEventListener("click", () => toggleVisibility("camera-mode-options"));
        document.getElementById("live-feed-control").addEventListener("click", () => toggleVisibility("live-feed-options"));
        document.getElementById("playback-mode").addEventListener("click", () => toggleVisibility("playback-options"));
        document.getElementById("exit").addEventListener("click", () => {
            if (confirm("Are you sure you want to exit?")) {
                window.close(); // Attempt to close the window
            }
        });
        function toggleVisibility(sectionId) {
            document.getElementById("camera-mode-options").style.display = "none";
            document.getElementById("live-feed-options").style.display = "none";
            document.getElementById("playback-options").style.display = "none";
            document.getElementById(sectionId).style.display = "block";
        }

        window.onload = async function startCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                const video = document.getElementById("camera-feed");
                video.srcObject = stream;
            } catch (error) {
                console.error("Error accessing camera:", error);
            }
        };
    </script> -->
</body>
</html>
